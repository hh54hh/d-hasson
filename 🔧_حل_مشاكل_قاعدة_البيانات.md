# ๐ง ุญู ูุดุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช - ูุธุงู ูุฑูุฒ ุงูุจุฏุฑ

## ๐จ ุงููุดุงูู ุงูุชู ุชู ุฅุตูุงุญูุง

### ุงููุดููุฉ ุงูุฃููู: ุนุฏู ุธููุฑ ุงููุดุชุฑูุงุช ูู ูุดู ุงูุญุณุงุจ

**ุงูุณุจุจ:** ุฌุฏูู `sale_items` ููููุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
**ุงููุชูุฌุฉ:** ูุง ูุชู ุญูุธ ุชูุงุตูู ุงูููุชุฌุงุช ุงููุดุชุฑุงุฉ

### ุงููุดููุฉ ุงูุซุงููุฉ: ุนุฏู ุชูููู ุงููุฎุฒู ุนูุฏ ุงูุจูุน

**ุงูุณุจุจ:** ุนุฏู ูุฌูุฏ ุงูุฌุฏุงูู ูุงูุนูุงูุงุช ุงูุตุญูุญุฉ ูุชุญุฏูุซ ุงููููุงุช
**ุงููุชูุฌุฉ:** ุงูุจูุน ูุชู ููู ุงููููุงุช ูุง ุชููุต ูู ุงููุฎุฒู

### ุงููุดููุฉ ุงูุซุงูุซุฉ: ุนุฏู ุงูุชูุงู ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุณุจุจ:** ููุต ูู schema ูุงุนุฏุฉ ุงูุจูุงูุงุช
**ุงููุชูุฌุฉ:** ุนุฏู ุชุณุฌูู ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ

---

## โก ุงูุญู ุงูุณุฑูุน

### ุงูุฎุทูุฉ 1: ุชุดุบูู ุณูุฑูุจุช ุงูุฅุตูุงุญ

1. ุงูุชุญ ูููุน **Supabase** ูู ุงููุชุตูุญ
2. ุงุฐูุจ ุฅูู ูุดุฑูุนู (PAW Inventory)
3. ุงุถุบุท ุนูู **SQL Editor** ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
4. ุงูุณุฎ ูุญุชูู ููู `CRITICAL_DATABASE_FIX.sql`
5. ุงูุตูู ูู ูุญุฑุฑ SQL ูุงุถุบุท **Run**

### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ูุฌุงุญ ุงูุฅุตูุงุญ

ุจุนุฏ ุชุดุบูู ุงูุณูุฑูุจุชุ ุณุชุธูุฑ ุฑุณุงุฆู ุงูุชุญูู:

- โ `ูุฌุญ: ุฌููุน ุงูุฌุฏุงูู ููุฌูุฏุฉ`
- โ `ูุฌุญ: ุงูุนูุงูุงุช ููุฌูุฏุฉ`
- โ `ูุฌุญ: ูููู ุงูุฌุฏูู ุตุญูุญ`

---

## ๐ฏ ูุง ุชู ุฅุตูุงุญู ุจุงูุชูุตูู

### 1. ุฅูุดุงุก ุฌุฏูู sale_items

```sql
-- ุงูุขู ูุชู ุญูุธ ุชูุงุตูู ูู ููุชุฌ ูู ุงูุจูุนุฉ
CREATE TABLE sale_items (
    id UUID PRIMARY KEY,
    sale_id UUID REFERENCES sales(id),
    product_id UUID REFERENCES products(id),
    product_name TEXT NOT NULL,
    quantity INTEGER NOT NULL,
    unit_price DECIMAL(10,2) NOT NULL,
    total_amount DECIMAL(10,2) NOT NULL,
    profit_amount DECIMAL(10,2) DEFAULT 0
);
```

### 2. ุฅุถุงูุฉ Triggers ูุชุญุฏูุซ ุงููุฎุฒู ุชููุงุฆูุงู

```sql
-- ุนูุฏ ุฅุถุงูุฉ ููุชุฌ ูุจูุนุฉุ ูููุต ูู ุงููุฎุฒู ุชููุงุฆูุงู
CREATE TRIGGER update_product_quantity_trigger
    AFTER INSERT ON sale_items
    FOR EACH ROW
    EXECUTE FUNCTION update_product_quantity_on_sale();
```

### 3. ุชุญุณูู ูุธุงู ูุดู ุงูุญุณุงุจ

- **ูุจู ุงูุฅุตูุงุญ:** "ูุง ุชูุฌุฏ ูุดุชุฑูุงุช ููุนููู"
- **ุจุนุฏ ุงูุฅุตูุงุญ:** ุนุฑุถ ุชูุตููู ููู ุงูููุชุฌุงุช ูุงููููุงุช ูุงูุฃุณุนุงุฑ

### 4. ุฅุตูุงุญ ุฏุงูุฉ createSaleWithCart

- **ุชุญูู ูู ุงููููุงุช ูุจู ุงูุจูุน**
- **ุชุญุฏูุซ ุงููุฎุฒู ููุฑุงู ุจุนุฏ ุงูุจูุน**
- **ุญูุธ ุชูุงุตูู ุงูููุชุฌุงุช ูู sale_items**
- **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุฅุฐุง ูุดู ุฃู ุดูุก**

---

## ๐ ููููุฉ ุงูุชุญูู ูู ูุฌุงุญ ุงูุญู

### ุงุฎุชุจุงุฑ 1: ุฅูุดุงุก ุจูุนุฉ ุฌุฏูุฏุฉ

1. ุงุฐูุจ ุฅูู **ุฅุถุงูุฉ ุจูุนุฉ**
2. ุงุฎุช๏ฟฝ๏ฟฝ ุนููู ูุฃุถู ููุชุฌุงุช ููุณูุฉ
3. ุฃููู ุงูุจูุนุฉ
4. โ ูุฌุจ ุฃู ุชูู ูููุฉ ุงูููุชุฌุงุช ูู ุงููุฎุฒู

### ุงุฎุชุจุงุฑ 2: ุทุจุงุนุฉ ูุดู ุญุณุงุจ

1. ุงุฐูุจ ุฅูู **ููุญุฉ ุงูุชุญูู**
2. ุงุฎุชุฑ ุนููู ูู ูุดุชุฑูุงุช
3. ุงุถุบุท **ุทุจุงุนุฉ ูุดู ุงูุญุณุงุจ**
4. โ ูุฌุจ ุฃู ุชุธูุฑ ุฌููุน ุงูููุชุฌุงุช ุงููุดุชุฑุงุฉ ูุน ุงูุชูุงุตูู

### ุงุฎุชุจุงุฑ 3: ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

1. ุงุฐูุจ ุฅูู **ุงูุฅุนุฏุงุฏุงุช** ูู ุงููุธุงู
2. ุงูุธุฑ ููุณู **ุญุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช**
3. โ ูุฌุจ ุฃู ุชุธูุฑ "ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุนูู ุจุดูู ุตุญูุญ"

---

## ๐ ูุง ูุญุฏุซ ุงูุขู ุจุนุฏ ุงูุฅุตูุงุญ

### ุนูุฏ ุฅุฌุฑุงุก ุจูุนุฉ:

1. โ ูุชู ุงูุชุญูู ูู ุชููุฑ ุงููููุฉ
2. โ ุชูุญูุธ ุงูุจูุนุฉ ุงูุฑุฆูุณูุฉ ูู ุฌุฏูู `sales`
3. โ ุชูุญูุธ ุชูุงุตูู ูู ููุชุฌ ูู ุฌุฏูู `sale_items`
4. โ ุชูุญุฏุซ ูููุงุช ุงูููุชุฌุงุช ูู ุงููุฎุฒู ุชููุงุฆูุงู
5. โ ููุญุฏุซ ุฑุตูุฏ ุงูุนููู ูุงูุฏููู

### ุนูุฏ ุทุจุงุนุฉ ูุดู ุงูุญุณุงุจ:

1. โ ูุชู ุฌูุจ ุฌููุน ูุดุชุฑูุงุช ุงูุนููู ูู `sale_items`
2. โ ุชุธูุฑ ุชูุงุตูู ูู ููุชุฌ (ุงูุงุณูุ ุงููููุฉุ ุงูุณุนุฑ)
3. โ ููุญุณุจ ุฅุฌูุงูู ุงููุดุชุฑูุงุช ูุงููุฏููุน ูุงููุชุจูู
4. โ ุชุธูุฑ ุฌููุน ุนูููุงุช ุชุณุฏูุฏ ุงูุฏููู

---

## ๐ก๏ธ ุงูุญูุงูุฉ ูู ุงูุฃุฎุทุงุก

### ุญูุงูุฉ ุงููููุงุช:

- โ ูุง ูููู ุจูุน ูููุฉ ุฃูุจุฑ ูู ุงููุชููุฑ
- โ๏ธ ุชุญุฐูุฑ ุนูุฏ ุงููุตูู ููุญุฏ ุงูุฃุฏูู
- ๐ ุชุญุฏูุซ ููุฑู ูููุฎุฒู

### ุญูุงูุฉ ุงูุจูุงูุงุช:

- ๐ ุงูุนูุงูุงุช ูุญููุฉ ุจู Foreign Keys
- ๐๏ธ ุญุฐู ูุชุชุงูู ุขูู ููุจูุงูุงุช ุงููุฑุชุจุทุฉ
- ๐พ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู

---

## ๐ ุฅุฐุง ูู ูุนูู ุงูุญู

### 1. ุชุญูู ูู ุงูุงุชุตุงู

- ุชุฃูุฏ ูู ูุฌูุฏ ุงุชุตุงู ุฅูุชุฑูุช ูุณุชูุฑ
- ุชุญูู ูู ุตุญุฉ ุฅุนุฏุงุฏุงุช Supabase ูู `.env`

### 2. ุชุญูู ูู ุงูุตูุงุญูุงุช

- ุชุฃูุฏ ูู ุฃู ูุฏูู ุตูุงุญูุงุช ุชุนุฏูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุญูู ูู Row Level Security policies

### 3. ุฅุนุงุฏุฉ ุชุดุบูู ุงููุธุงู

```bash
npm run dev
```

### 4. ุชูุธูู ุงููุงุด

- ุงูุณุญ ุจูุงูุงุช ุงููุชุตูุญ ุงููุคูุชุฉ
- ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ ุจู Ctrl+F5

---

## ๐ ุงูุฏุนู ุงูููู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู:

1. ุชุญูู ูู console ุงููุชุตูุญ ููุฃุฎุทุงุก
2. ุฑุงุฌุน logs ูู Supabase Dashboard
3. ุชุฃูุฏ ูู ุชุทุจูู ุฌููุน ุฎุทูุงุช ุงูุฅุตูุงุญ

**ุชู ุจูุงุก ูุฐุง ุงูุญู ุฎุตูุตุงู ููุธุงู ูุฑูุฒ ุงูุจุฏุฑ ููุฌุจ ุฃู ูุญู ุฌููุน ุงููุดุงูู ุงููุฐููุฑุฉ! ๐**
